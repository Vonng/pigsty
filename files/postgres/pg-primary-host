#!/bin/bash
set -uo pipefail
#==============================================================#
# File      :   pg-primary-host
# Desc      :   retrieve patroni primary member host from patroni REST API
# Path      :   /pg/bin/pg-primary-host
# Depend    :   patroni
# License   :   AGPLv3 @ https://pigsty.io/docs/about/license
# Author    :   waiting
#==============================================================#

name=$(/usr/bin/patronictl -c /pg/bin/patroni.yml list -f json 2>/dev/null | jq -r '.[] | select(.Role == "Leader") | .Host' )
echo $name

